<div class="flex flex-col gap-1 w-full">
  <div class="relative">
    <!-- Ícono izquierdo -->
    <span class="absolute inset-y-0 left-0 flex items-center pl-4 text-gray-400 z-10">
      <i class="material-icons-outlined text-lg">{{ icon }}</i>
    </span>

    <!-- Select -->
    <select
      [id]="fieldId"
      [value]="value"
      [disabled]="disabled"
      class="pl-12 pr-10 py-3 w-full border-2 rounded-lg focus:outline-none transition-all duration-200 peer custom-input bg-white font-normal appearance-none cursor-pointer"
      [ngClass]="{
        'border-gray-200 focus:border-orange-500 hover:border-gray-300': !touched,
        'border-green-500 focus:border-green-600': valid && touched,
        'border-red-500 focus:border-red-600': invalid && touched,
        'bg-gray-50 cursor-not-allowed': disabled
      }"
      (focus)="onFocus()"
      (blur)="onBlur()"
      (change)="onSelectionChange($event)"
      (click)="onClick()"
    >
      <option value="" disabled hidden></option>
      <option
        *ngFor="let option of options"
        [value]="option.value"
        [disabled]="option.disabled"
        class="py-2 px-3 hover:bg-orange-50"
      >
        {{ option.label }}
      </option>
    </select>

    <!-- Icono de dropdown -->
    <span
      class="absolute inset-y-0 right-0 flex items-center pr-3 text-gray-400 pointer-events-none transition-all duration-200"
    >
      <i class="material-icons-outlined text-lg">{{ isOpen ? 'expand_less' : 'expand_more' }}</i>
    </span>

    <!-- Label flotante -->
    <label
      [for]="fieldId"
      class="absolute left-12 transition-all duration-200 pointer-events-none transform origin-left z-10 bg-white px-1"
      [ngClass]="{
        'top-3 text-gray-500 text-base scale-100': !hasValue && !isFocused,
        '-top-2 text-xs scale-90': hasValue || isFocused,
        'text-orange-500': (isFocused && !invalid) || (!touched && hasValue) || (touched && valid),
        'text-green-500': valid && touched,
        'text-red-500': invalid && touched,
        'text-gray-400': disabled
      }"
    >
      {{ label }}
    </label>
  </div>

  <!-- Mensaje de error (opcional) -->
  <div *ngIf="invalid && touched && errorMessage" class="text-red-500 text-xs mt-1 ml-1 animate-fade-in">
    {{ errorMessage }}
  </div>

  <!-- Mensaje de ayuda (opcional) -->
  <div *ngIf="helpText && !invalid" class="text-gray-500 text-xs mt-1 ml-1">
    {{ helpText }}
  </div>
</div>
